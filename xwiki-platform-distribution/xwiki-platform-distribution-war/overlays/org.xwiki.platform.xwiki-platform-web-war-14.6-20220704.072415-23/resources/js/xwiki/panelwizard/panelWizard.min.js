function computeBounds(){leftPanelsLeft=getX(leftPanels);leftPanelsRight=leftPanelsLeft+leftPanels.offsetWidth;rightPanelsLeft=getX(rightPanels);rightPanelsRight=rightPanelsLeft+rightPanels.offsetWidth;allpanelsLeft=getX(allPanels);allpanelsTop=getY(allPanels)}function debugwrite(a){document.getElementById("headerglobal").appendChild(document.createTextNode(a))}function isPanel(a){return a&&1===a.nodeType&&a.classList.contains("panel")&&$(a).up("#leftPanels, #rightPanels, #allviewpanels")}
function getX(a){return a.offsetParent?window.ActiveXObject?a.offsetLeft+getX(a.offsetParent)+a.clientLeft:a.offsetLeft+getX(a.offsetParent)+(a.scrollWidth-a.clientWidth):a.x?a.x:0}function getY(a){return a.offsetParent?window.ActiveXObject?a.offsetTop+getY(a.offsetParent)+a.clientTop:a.offsetTop+getY(a.offsetParent)+(a.scrollHeight-a.clientHeight):a.y?a.y:0}
function getBlocList(a){for(var c=[],b=a.childNodes.length,d=0;d<b;++d){var e=a.childNodes[d];isPanel(e)&&(e.isDragging||c.push(e))}return c}function getDragBoxPos(a,c){c=a.length;if(0==c)return 0;for(var b=0;b<c;++b)if(a[b]==dragel)return b;return-1}function getAllPanels(a){var c=[];a=a.getElementsByTagName("div");for(var b=0,d=0;d<a.length;++d)isPanel(a[d])&&(c[b]=a[d],b++);return c}
function getClosestDropTarget(a,c,b,d){return 1==window.showLeftColumn&&a<=leftPanelsRight&&a+b>=leftPanelsLeft?leftPanels:1==window.showRightColumn&&a+b>=rightPanelsLeft&&a<=rightPanelsRight?rightPanels:allPanels}
function onDragStart(a,c,b){if(!a.isDragging){hideTip();window.isDraggingPanel=!0;1==enabletip&&hideTip();parentNode=realParent=a.parentNode;var d=realParent!=leftPanels&&realParent!=rightPanels;b=Position.cumulativeOffset(a);var e=Position.realOffset(a);c=b[0];b=b[1]-e[1]+(document.documentElement.scrollTop-0+document.body.scrollTop-0);dragel.style.height=window.ActiveXObject?(a.offsetHeight?a.offsetHeight:a.displayHeight)+"px":(a.offsetHeight?a.offsetHeight-2:a.displayHeight)+"px";dragel.style.display=
"block";a.style.left=c+"px";a.style.top=b+"px";a.style.zIndex="10";d?(parentNode=allPanels,a.placeholder=document.createElement("div"),a.placeholder.className="placeholder",a.placeholder.style.height=window.ActiveXObject?(a.offsetHeight?a.offsetHeight:a.displayHeight)+"px":(a.offsetHeight?a.offsetHeight-2:a.displayHeight)+"px",realParent.replaceChild(a.placeholder,a),a.placeholder.style.display="block",addClass(allPanels,"dropTarget")):realParent.replaceChild(dragel,a);a.style.position="absolute";
document.body.appendChild(a);a.isDragging=!0;prevcolumn=parentNode}}
function onDrag(a,c,b){1==enabletip&&hideTip();parentNode=getClosestDropTarget(c,b,a.offsetWidth,a.offsetHeight);parentNode!=prevcolumn&&(prevcolumn!=allPanels&&prevcolumn.removeChild(dragel),parentNode!=allPanels?(parentNode.appendChild(dragel),rmClass(allPanels,"dropTarget")):addClass(allPanels,"dropTarget"));prevcolumn=parentNode;a=getBlocList(parentNode);c=getDragBoxPos(a,b);-1!=c&&(0==a.length?parentNode!=allPanels&&parentNode.appendChild(dragel):0!=c&&b<=getY(a[c-1])?parentNode.insertBefore(dragel,
a[c-1]):c!=a.length-1&&b>=getY(a[c+1])&&(a[c+2]?parentNode.insertBefore(dragel,a[c+2]):parentNode!=allPanels?parentNode.appendChild(dragel):dragel.parentNode.removeChild(dragel)))}function onDragEnd(a,c,b){a.isDragging=!1;window.isDraggingPanel=!1;a.style.position="static";parentNode==allPanels?(a.placeholder.parentNode.replaceChild(a,a.placeholder),a.placeholder=void 0,rmClass(allPanels,"dropTarget")):parentNode.replaceChild(a,dragel);dragel.style.display="none";updatePanelLayout()}
var updatePanelLayout=function(){leftPanelsInput&&!leftPanelsInput.disabled&&(leftPanelsInput.value=getBlocNameList(leftPanels));rightPanelsInput&&!rightPanelsInput.disabled&&(rightPanelsInput.value=getBlocNameList(rightPanels))};
function executeCommand(a,c){function b(){4==d.readyState&&(200==d.status?e?e(d.responseText):new XWiki.widgets.Notification("no callback defined","error"):new XWiki.widgets.Notification("There was a problem retrieving the xml data:\n"+d.status+":\t"+d.statusText+"\n"+d.responseText,"error"))}var d=null,e=c;window.XMLHttpRequest?(d=new XMLHttpRequest,d.onreadystatechange=b,d.open("GET",a,!0),d.send(null)):window.ActiveXObject?(d=new ActiveXObject("Microsoft.XMLHTTP"),d.onreadystatechange=b,d.open("GET",
a,!0),d.send()):new XWiki.widgets.Notification("your browser does not support xmlhttprequest","error")}
function start1(){var a,c=document.getElementsByTagName("div");for(a=0;a<c.length;++a){var b=c[a];isPanel(b)&&attachDragHandler(b)}window.panelsInList=getAllPanels(allPanels);window.panelsOnLeft=getBlocList(leftPanels);window.panelsOnRight=getBlocList(rightPanels);for(a=0;a<panelsInList.length;++a)b=window.allPanelsPlace[a].left,-1!=b&&(b=panelsOnLeft[b])&&(b.fullname=window.allPanelsPlace[a].fullname,b.placeholder=document.createElement("div"),b.placeholder.className="placeholder",b.displayHeight=
window.ActiveXObject?b.offsetHeight?b.offsetHeight:0:b.offsetHeight?b.offsetHeight-2:0,b.placeholder.style.height=b.displayHeight+"px",b.placeholder.style.display="block",panelsInList[a].parentNode.replaceChild(b.placeholder,panelsInList[a])),b=window.allPanelsPlace[a].right,-1!=b&&(b=panelsOnRight[b])&&(b.fullname=window.allPanelsPlace[a].fullname,b.placeholder=document.createElement("div"),b.placeholder.className="placeholder",b.displayHeight=window.ActiveXObject?b.offsetHeight?b.offsetHeight:0:
b.offsetHeight?b.offsetHeight-2:0,b.placeholder.style.height=b.displayHeight+"px",b.placeholder.style.display="block",panelsInList[a].parentNode&&panelsInList[a].parentNode.replaceChild(b.placeholder,panelsInList[a])),panelsInList[a].fullname=window.allPanelsPlace[a].fullname;leftPanels.savedPanelList=getBlocList(leftPanels);rightPanels.savedPanelList=getBlocList(rightPanels);leftPanels.isVisible=window.showLeftColumn;rightPanels.isVisible=window.showRightColumn;leftPanels.isVisible||(leftPanels.panels=
getBlocList(leftPanels));rightPanels.isVisible||(rightPanels.panels=getBlocList(rightPanels));layoutMaquettes=$("PageLayoutSection").select(".pagelayoutoption")}function attachDragHandler(a){a.ondblclick=function(c){};Drag.init(a,a);a.onDragStart=function(c,b){onDragStart(this,c,b)};a.onDrag=function(c,b){onDrag(this,c,b)};a.onDragEnd=function(c,b){onDragEnd(this,c,b)}}function isAttachedPanel(a){return a.ondblclick?!0:!1}
function getBlocNameList(a){for(var c="",b=a.childNodes.length,d=0;d<b;++d){var e=a.childNodes[d];isPanel(e)&&!e.isDragging&&(""!=c&&(c+=","),c+=e.fullname)}return c}
function save(){var a=window.ajaxurl;a+="&showLeftPanels="+window.showLeftColumn;a+="&showRightPanels="+window.showRightColumn;if(window.showLeftColumn){var c=leftPanelsInput?leftPanelsInput.value:getBlocNameList(leftPanels);a+="&leftPanels="+encodeURIComponent(c);a+="&leftPanelsWidth="+leftPanelsWidthInput.value}window.showRightColumn&&(c=rightPanelsInput?rightPanelsInput.value:getBlocNameList(rightPanels),a+="&rightPanels="+encodeURIComponent(c),a+="&rightPanelsWidth="+rightPanelsWidthInput.value);
executeCommand(a,saveResult)}function saveResult(a){"SUCCESS"==a?(new XWiki.widgets.Notification(window.panelsavesuccess,"done"),leftPanels.savedPanelList=getBlocList(leftPanels),rightPanels.savedPanelList=getBlocList(rightPanels),leftPanels.isVisible=window.showLeftColumn,rightPanels.isVisible=window.showRightColumn):(alert(window.panelsaveerror),alert(a))}function releasePanels(a){a.panels=getBlocList(a);for(var c=0;c<a.panels.length;++c)releasePanel(a.panels[c])}
function releasePanel(a){a.parentNode.removeChild(a);a.placeholder.parentNode.replaceChild(a,a.placeholder);a.placeholder=void 0}function restorePanels(a){for(var c=0;c<a.panels.length;++c)a.panels[c].placeholder||restorePanel(a.panels[c],a);a.panels=void 0}function revertPanels(a){for(var c=0;c<a.savedPanelList.length;++c)restorePanel(a.savedPanelList[c],a)}
function restorePanel(a,c){a.placeholder=document.createElement("div");a.placeholder.className="placeholder";a.placeholder.style.height=window.ActiveXObject?a.offsetHeight?a.offsetHeight:0:a.offsetHeight?a.offsetHeight-2:0;a.placeholder.style.display="block";a.parentNode.replaceChild(a.placeholder,a);c.appendChild(a)}
function changePreviewLayout(a,c){document.getElementById("selectedoption").id="";a.id="selectedoption";mainContainer.removeClassName("hidelefthideright");mainContainer.removeClassName("hideright");mainContainer.removeClassName("hideleft");mainContainer.removeClassName("content");switch(c){case 0:1==window.showLeftColumn&&(window.showLeftColumn=0,leftPanels.style.display="none",releasePanels(leftPanels));1==window.showRightColumn&&(window.showRightColumn=0,rightPanels.style.display="none",releasePanels(rightPanels));
mainContainer.addClassName("hidelefthideright");leftPanelsInput&&leftPanelsInput.disable();leftPanelsWidthInput.disable();rightPanelsInput&&rightPanelsInput.disable();rightPanelsWidthInput.disable();break;case 1:0==window.showLeftColumn&&(window.showLeftColumn=1,leftPanels.style.display="block",restorePanels(leftPanels));1==window.showRightColumn&&(window.showRightColumn=0,rightPanels.style.display="none",releasePanels(rightPanels));mainContainer.addClassName("hideright");leftPanelsInput&&leftPanelsInput.enable();
leftPanelsWidthInput.enable();rightPanelsInput&&rightPanelsInput.disable();rightPanelsWidthInput.disable();break;case 2:1==window.showLeftColumn&&(window.showLeftColumn=0,leftPanels.style.display="none",releasePanels(leftPanels));0==window.showRightColumn&&(window.showRightColumn=1,rightPanels.style.display="block",restorePanels(rightPanels));mainContainer.addClassName("hideleft");leftPanelsInput&&leftPanelsInput.disable();leftPanelsWidthInput.disable();rightPanelsInput&&rightPanelsInput.enable();
rightPanelsWidthInput.enable();break;case 3:0==window.showLeftColumn&&(window.showLeftColumn=1,leftPanels.style.display="block",restorePanels(leftPanels)),0==window.showRightColumn&&(window.showRightColumn=1,rightPanels.style.display="block",restorePanels(rightPanels)),mainContainer.addClassName("content"),leftPanelsInput&&leftPanelsInput.enable(),leftPanelsWidthInput.enable(),rightPanelsInput&&rightPanelsInput.enable(),rightPanelsWidthInput.enable()}computeBounds()}
function revert(){releasePanels(leftPanels);releasePanels(rightPanels);revertPanels(leftPanels);revertPanels(rightPanels);var a=0;leftPanels.isVisible&&(a+=1);rightPanels.isVisible&&(a+=2);setPanelWidth();changePreviewLayout(layoutMaquettes[a],a);updatePanelLayout()}
function setPanelWidth(){for(var a=["Small","Medium","Large"],c=0;c<a.length;++c){var b=a[c];mainContainer.removeClassName("panel-left-width-"+b);mainContainer.removeClassName("panel-right-width-"+b);window.leftPanels.removeClassName("panel-width-"+b);window.rightPanels.removeClassName("panel-width-"+b)}b=c="Medium";0<=a.indexOf(leftPanelsWidthInput.value)&&(c=leftPanelsWidthInput.value);0<=a.indexOf(rightPanelsWidthInput.value)&&(b=rightPanelsWidthInput.value);mainContainer.addClassName("panel-left-width-"+
c);mainContainer.addClassName("panel-right-width-"+b);window.leftPanels.addClassName("panel-width-"+c);window.rightPanels.addClassName("panel-width-"+b)}
function panelEditorInit(){tipobj=$("dhtmltooltip");realParent=parentNode=null;dragel=new Element("div",{id:"dragbox","class":"panel"});nb=dragWidth=0;layoutMaquetes=null;window.leftPanels=$("leftPanels");window.rightPanels=$("rightPanels");allPanels=$("allviewpanels");mainContent=$("contentcolumn");mainContainer=$("body");leftPanelsLeft=getX(leftPanels);leftPanelsRight=leftPanelsLeft+leftPanels.offsetWidth;rightPanelsLeft=getX(rightPanels);rightPanelsRight=rightPanelsLeft+rightPanels.offsetWidth;
allpanelsLeft=getX(allPanels);allpanelsTop=getY(allPanels);leftPanelsInput=$("XWiki.XWikiPreferences_0_leftPanels");leftPanelsWidthInput=$("XWiki.XWikiPreferences_0_leftPanelsWidth");rightPanelsInput=$("XWiki.XWikiPreferences_0_rightPanels");rightPanelsWidthInput=$("XWiki.XWikiPreferences_0_rightPanelsWidth");leftPanelsWidthInput.observe("change",setPanelWidth);rightPanelsWidthInput.observe("change",setPanelWidth);prevcolumn=allPanels;start1();var a=$("selectedoption");changePreviewLayout(a,a.previousSiblings().length)}
function waitForAsync(a){!document.getElementsByClassName("xwiki-async").length||1E3<a?panelEditorInit():setTimeout(waitForAsync,10,a+10)}waitForAsync(0);

//# sourceMappingURL=panelWizard.min.js.map

'use strict';require(["jquery"],function(c){var m=function(a){a.trigger("xwiki:flavorpicker:updated",{elements:a[0]})},t=function(){q();r()},r=function(){var a="$escapetool.javascript($services.flavor.getSearchValidFlavorsStatusURL(''))",b=c(".xwiki-flavor-picker");a+=encodeURIComponent(b.attr("data-namespace"));c.getJSON(a).then(d=>{var f=d.state,e=c("#xwiki-flavor-picker-progress-background");if(e.length){var g=c("#xwiki-flavor-picker-progress-bar");e.find("input").attr("value",f);"RUNNING"==f?
(e.removeClass("hidden"),g.css("width",100*d.progress.offset+"%")):e.addClass("hidden");n()}}).catch(()=>{new XWiki.widgets.Notification("$escapetool.javascript($services.localization.render('flavor.picker.ajaxError'))","error")})},q=function(){var a="$escapetool.javascript($doc.getURL('get', 'xpage=flavor/picker_flavors'))",b=c(".xwiki-flavor-picker");a+="&namespace="+encodeURIComponent(b.attr("data-namespace"));c.getJSON(a).then(d=>{c.each(d,function(f,e){u(f,e)});p(c(".xwiki-flavor-picker"))}).catch(()=>
{new XWiki.widgets.Notification("$escapetool.javascript($services.localization.render('flavor.picker.ajaxError'))","error")})},u=function(a,b){var d=c(".xwiki-flavor-picker"),f=d.find('input[name="fieldName"]').attr("value");d=d.find("ul");var e=b.id.id+":::"+b.id.version.value;if(0==d.find('input[value="'+e+'"]').length){var g=c('<li class="xwiki-flavor-picker-option"></li>');g.append(c('<input type="radio"/>').attr("name",f).attr("value",e).attr("id",f+"_"+a));g.append("<span class=\"xwiki-flavor-picker-option-icon\">$escapetool.javascript($services.icon.renderHTML('wiki'))</span>");
e=c("<div></div>");var h=c("<div></div>");h.attr("for",f+"_"+a);a=null!=b.name&&""!=b.name?b.name:b.id.id;null!=b.website&&""!=b.website?h.append(c('<a class="popup"></a>').attr("href",b.website).text(a)):h.text(a);h.append(" ");h.append(c("<small></small>").text(b.id.version.value));null!=b.rating&&0<b.rating&&h.append(Array(Math.round(b.rating)).join("$escapetool.javascript($services.icon.renderHTML('star'))"));e.append(h);if(0<b.authors.length){a=c('<p class="authors"></p>');var k=c("<small></small>");
k.text("$escapetool.javascript($services.localization.render('flavor.picker.authorsBy')) ");c.each(b.authors,function(v,l){0<v&&k.append(", ");null!=l.url&&""!=l.url?k.append(c("<a></a>").attr("href",l.url).text(l.name)):k.append(l.name)});a.append(k);e.append(a)}null!=b&&""!=b.summary&&e.append(c('<p class="xHint"></p>').text(b.summary));g.append(c('<input type="hidden" name="match"/>').attr("value",JSON.stringify(b)));g.append(e);d.append(g)}},n=function(){var a=c("#xwiki-flavor-picker-progress-background");
a.length&&"FINISHED"!=a.find("input").attr("value")&&setTimeout(t,100)},w=function(a){var b=c(".xwiki-flavor-picker");"string"!==typeof a||""===a.trim()?b.find("li").removeClass("hidden"):b.find("li").each(function(d){d=c(this);-1<d.find('input[name="match"]').attr("value").toLowerCase().indexOf(a)?d.removeClass("hidden"):d.addClass("hidden")})},p=function(a){a.find(".xwiki-flavor-picker-option").on("click",function(b){b=c(this);var d=b.parents(".xwiki-flavor-picker");d.find(".xwiki-flavor-picker-option-selected").removeClass("xwiki-flavor-picker-option-selected");
b.find("input").prop("checked",!0);b.addClass("xwiki-flavor-picker-option-selected");m(d)});a.find(".xwiki-flavor-picker-option a.popup").on("click",function(b){window.open(this.href,"flavor-popup",config="height=600, width=700, toolbar=no, menubar=no, scrollbars=yes, resizable=yes, location=no, directories=no, status=yes");return!1});m(a)};c(function(){p(c(".xwiki-flavor-picker"));c("input.xwiki-flavor-picker-filter").on("keyup",function(){var a=c(this).val();w(a)});c(".xwiki-flavor-picker-noflavor").on("click",
function(a){a=c(this).parents(".xwiki-flavor-picker");a.find(".xwiki-flavor-picker-option-selected").removeClass("xwiki-flavor-picker-option-selected");m(a)});n()})});

//# sourceMappingURL=picker.min.js.map

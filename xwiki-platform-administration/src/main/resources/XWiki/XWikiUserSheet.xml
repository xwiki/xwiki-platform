<?xml version="1.0" encoding="ISO-8859-1"?>

<xwikidoc>
<web>XWiki</web>
<name>XWikiUserSheet</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>1</translation>
<parent>XWiki.XWikiUsers</parent>
<creator>XWiki.Admin</creator>
<author>XWiki.Admin</author>
<customClass></customClass>
<contentAuthor>XWiki.Admin</contentAuthor>
<creationDate>1106308018000</creationDate>
<date>1228221302000</date>
<contentUpdateDate>1228221302000</contentUpdateDate>
<version>1.1</version>
<title></title>
<template></template>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment></comment>
<minorEdit>false</minorEdit>
<syntaxId>xwiki/1.0</syntaxId>
<hidden>false</hidden>
<object>
<class>
<name>XWiki.TagClass</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<validationScript></validationScript>
<tags>
<cache>0</cache>
<displayType>input</displayType>
<multiSelect>1</multiSelect>
<name>tags</name>
<number>1</number>
<prettyName>Tags</prettyName>
<relationalStorage>1</relationalStorage>
<separator> </separator>
<separators> ,|</separators>
<size>30</size>
<unmodifiable>0</unmodifiable>
<values></values>
<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
</tags>
</class>
<name>XWiki.XWikiUserSheet</name>
<number>0</number>
<className>XWiki.TagClass</className>
<property>
<tags/>
</property>
</object>
<content>#set($obj = $doc.getObject("XWiki.XWikiUsers"))
#if(!$obj)
  1 $msg.get("xe.admin.users.sheet")
     $msg.get("xe.admin.users.applyonusers")
#else

  #if($context.action=="view")
    &lt;div class="vcard"&gt;
  #end

  1 $msg.get("platform.core.profile.title", [$xwiki.getUserName($doc.fullName, false)])

  ##------------------------------------------------------------------
  ## Display a menu with common user actions:
  ##   - change password
  ##   - edit the profile
  ##   - change the avatar
  ##   - switch between simple/advanced modes
  ## Note: This menu is only displayed if the current profile page is
  ##       that of the currently logged user
  ##------------------------------------------------------------------
  #set($i = $context.user.indexOf(":")+1)
  #set($isMyProfile = ($doc.fullName == $context.user.substring($i)) &amp;&amp; ($context.action == "view"))
  #if($isMyProfile || $xwiki.hasAdminRights())
    #if($isMyProfile)
      #set($msgKeyEditSuffix = ".mine")
    #end
    &lt;div class="specialmenu"&gt;
      ## Check user is not from LDAP. In that case we can't modify the password has it is stored on LDAP server.
      #if (!$doc.getObject("XWiki.LDAPProfileClass"))
        * &lt;img alt="" src="$xwiki.getSkinFile("icons/keys.png")"/&gt; &lt;a href="$doc.getURL("view", "xpage=passwd")"&gt;$msg.get("platform.core.profile.changePassword$!{msgKeyEditSuffix}")&lt;/a&gt;
      #end
      * &lt;img alt="" src="$xwiki.getSkinFile("icons/contact.png")"/&gt; &lt;a href="$doc.getURL("inline")"&gt;$msg.get("platform.core.profile.modifyProfile$!{msgKeyEditSuffix}")&lt;/a&gt;
      * &lt;img alt="" src="$xwiki.getSkinFile("icons/changeavatar.png")"/&gt; &lt;a href="$doc.getURL("edit", "xpage=changemyavatar")"&gt;$msg.get("platform.core.profile.changePhoto$!{msgKeyEditSuffix}")&lt;/a&gt;
      ## Code to check whether the document's user with usertype advanced.
      #set($contextUserType = "$!{doc.getObject('XWiki.XWikiUsers').getProperty('usertype').value}")
      #if($contextUserType == 'Advanced')
        #set($isContextUserAdvanced = true)
      #else
        #set($isContextUserAdvanced = false)
      #end
      #if($isContextUserAdvanced)
        * &lt;img alt="" src="$xwiki.getSkinFile("icons/simpleuser.png")"/&gt; &lt;a href="$doc.getURL("save", "XWiki.XWikiUsers_${obj.number}_usertype=Simple")"&gt;$msg.get("platform.core.profile.switchSimple")&lt;/a&gt;
      #else
        * &lt;img alt="" src="$xwiki.getSkinFile("icons/advanceduser.png")"/&gt; &lt;a href="$doc.getURL("save", "XWiki.XWikiUsers_${obj.number}_usertype=Advanced")"&gt;$msg.get("platform.core.profile.switchAdvanced")&lt;/a&gt;
      #end
    &lt;/div&gt;
  #end

  #if($obj.getProperty("blogfeed") &amp;&amp; $obj.getProperty("blogfeed").getValue() != "")
    &lt;div class="xwikiuserblog"&gt;
      {rss:feed=$doc.display("blogfeed", "view", $obj)|count=5}
    &lt;/div&gt;
  #end

  #if($obj.getProperty("avatar") &amp;&amp; $obj.getProperty("avatar").getValue() != "")
    #foreach ($attach in $doc.attachmentList)
      #if($attach.filename == $obj.getProperty("avatar").getValue())
        &lt;a href="$doc.getAttachmentURL($attach.filename, "download")" &gt;
          &lt;img class="photo" id="xwikiuseravatar" alt="$doc.display("first_name", "view", $obj)" src="$doc.getAttachmentURL($attach.filename, "download")"/&gt;
        &lt;/a&gt;
      #end
    #end
  #end
  ## Please do not insert extra empty lines here (as it affects the validity of the rendered xhtml)
  &lt;dl id="xwikiuserprofile"&gt;
    &lt;dt class="label"&gt;&lt;label&gt;$msg.get("platform.core.profile.firstname"):&lt;/label&gt;&lt;/dt&gt;
    &lt;dd#if($context.action=="view") class="given-name"#end&gt;$doc.display("first_name", $obj)&lt;/dd&gt;
    &lt;dt class="label"&gt;&lt;label&gt;$msg.get("platform.core.profile.lastname"):&lt;/label&gt;&lt;/dt&gt;
    &lt;dd#if($context.action=="view") class="family-name"#end&gt;$doc.display("last_name", $obj)&lt;/dd&gt;
    #if(($obj.getProperty("blog") &amp;&amp; $obj.getProperty("blog").getValue() != "") || $context.action == "inline")
      &lt;dt class="label"&gt;&lt;label&gt;$msg.get("platform.core.profile.blog"):&lt;/label&gt;&lt;/dt&gt;
      &lt;dd&gt;$doc.display("blog", $obj)&lt;/dd&gt;
    #end
    #if(($obj.getProperty("blogfeed") &amp;&amp; $obj.getProperty("blogfeed").getValue() != "") || $context.action == "inline")
      &lt;dt class="label"&gt;&lt;label&gt;$msg.get("platform.core.profile.blogFeed"):&lt;/label&gt;&lt;/dt&gt;
      &lt;dd&gt;$doc.display("blogfeed", $obj)&lt;/dd&gt;
    #end
    ## For security reasons do not display emails by default
    ## #if(($obj.getProperty("email") &amp;&amp; $obj.getProperty("email").getValue() != "") || $context.action == "inline")
    ## &lt;dt class="label"&gt;&lt;label&gt;$msg.get("platform.core.profile.email"):&lt;/label&gt;&lt;/dt&gt;
    ## &lt;dd#if($context.action=="view") class="email"#end&gt;#if($action == "inline")$doc.display("email", $obj)#else #set($discard = $doc.display("email", $obj))#obfuscate($discard)#end&lt;/dd&gt;
    ## #end
    #if(($obj.getProperty("company") &amp;&amp; $obj.getProperty("company").getValue() != "") || $context.action == "inline")
      &lt;dt class="label"&gt;&lt;label&gt;$msg.get("platform.core.profile.company"):&lt;/label&gt;&lt;/dt&gt;
      &lt;dd#if($context.action=="view") class="org"#end&gt;$doc.display("company", $obj)&lt;/dd&gt;
    #end
    #if(($obj.getProperty("city") &amp;&amp; $obj.getProperty("city").getValue() != "") || $context.action == "inline")
      &lt;dt class="label"&gt;&lt;label&gt;$msg.get("platform.core.profile.city"):&lt;/label&gt;&lt;/dt&gt;
      &lt;dd#if($context.action=="view") class="locality"#end&gt;$doc.display("city", $obj)&lt;/dd&gt;
    #end
    #if(($obj.getProperty("country") &amp;&amp; $obj.getProperty("country").getValue() != "") || $context.action == "inline")
     &lt;dt class="label"&gt;&lt;label&gt;$msg.get("platform.core.profile.country"):&lt;/label&gt;&lt;/dt&gt;
     &lt;dd#if($context.action=="view") class="country-name"#end&gt;$doc.display("country", $obj)&lt;/dd&gt;
    #end
  &lt;/dl&gt;

  #if(($obj.getProperty("comment") &amp;&amp; $obj.getProperty("comment").getValue().trim() != "") || $context.action == "inline")
    1.1 $msg.get("platform.core.profile.about")
    $doc.display("comment", $obj)
  #end

  #if($context.action=="view")
    &lt;/div&gt;
  #end

#end
</content></xwikidoc>
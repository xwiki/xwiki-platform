###
### Main "edit" template
###
### General wrapper for edit actions
###
##
## Determine what editor to show
##
$xwiki.jsfx.use('js/scriptaculous/scriptaculous.js')
$xwiki.jsfx.use('js/xwiki/actionbuttons/actionButtons.js', true)
#if("$!editor" == '')
#set($editor = $request.getParameter("editor"))
#if("$!editor" == '')
#if(($xwiki.getUserPreference("editor")=="Wysiwyg")&&($doc.SyntaxId!="xwiki/1.0"||!$doc.isAdvancedContent()))
#set($editor="wysiwyg")
#else
#set($editor="wiki")
#end
#end
#end
##
## "Compute" the title
##
#set($title = $xwiki.parseContent($msg.get("editpageTitle")))
##
## Header
##
#template("xwikivars.vm")
#template("layoutvars.vm")
#template("htmlheader.vm")
#template("header.vm")
#template("menuedit.vm")
#if($editor == "wiki" || $editor == "wysiwyg")
<form id="edit" method="post" action="$doc.getURL("preview")" >
## This input is used by the full screen widget: it stores the selector of the maximized element, so that the full screen can be restored when coming back from preview.
<div class="hidden"><input type="hidden" name="x-maximized" value="$!{request.get('x-maximized')}"/></div>
#end
##
## Content
##
#set($force = $!request.get('force'))
#if (($tdoc.getLocked()==true)&&(!$force))
<div class="layoutsection">
#xwikimessageboxstart($msg.get("notice") "$msg.get('doclockedby') $xwiki.getLocalUserName($doc.getLockingUser())")
<a href="$doc.getURL($context.action, "$!{request.getQueryString().replaceAll('&', '&amp;').replaceAll('&amp;amp;', '&amp;')}&amp;force=1")">$msg.get("forcelock")</a>
#xwikimessageboxend()
</div>
#else
<div id="xwikieditor" class="layoutsection">
<div id="xwikieditorinner">
<div class="leftsidecolumns">
<div id="editcolumn" class="editor">
<div class="alleditcontent">
#if($editor == "wiki" || $editor == "wysiwyg")
#set($docTitle = $request.getParameter("title"))
#if("$!docTitle" == "")
#set($docTitle = $!tdoc.title)
#end
<label>$msg.get("titlefield"):
<input type="text" id="xwikidoctitleinput" name="title" value="$!docTitle"/></label>
#end
#template("editmodes.vm")
#template("edit${editor}.vm")
</div> ## alleditcontent
</div> ## editcolumn
<div class="clearfloats"></div>
</div> ## leftsidecolumns
#template("editpanels.vm")
<div class="clearfloats"></div>
</div> ## xwikieditorinner
#end
##
## Footer
##
</div> ## xwikieditor
#if($editor == "wiki" || $editor == "wysiwyg")
</form>
#end
#template("footer.vm")
#template("htmlfooter.vm")

<?xml version="1.1" encoding="UTF-8"?>

<!--
 * See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 * This is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation; either version 2.1 of
 * the License, or (at your option) any later version.
 *
 * This software is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this software; if not, write to the Free
 * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
 * 02110-1301 USA, or see the FSF site: http://www.fsf.org.
-->

<xwikidoc version="1.5" reference="XWiki.Notifications.Code.NotificationsWatchUIX" locale="">
  <web>XWiki.Notifications.Code</web>
  <name>NotificationsWatchUIX</name>
  <language/>
  <defaultLanguage/>
  <translation>0</translation>
  <creator>xwiki:XWiki.Admin</creator>
  <parent>XWiki.Notifications.Code.WebHome</parent>
  <author>xwiki:XWiki.Admin</author>
  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>
  <version>1.1</version>
  <title>NotificationsWatchUIX</title>
  <comment/>
  <minorEdit>false</minorEdit>
  <syntaxId>xwiki/2.1</syntaxId>
  <hidden>true</hidden>
  <content>Technical page holding information for the watch setting of each page.</content>
  <object>
    <name>XWiki.Notifications.Code.NotificationsWatchUIX</name>
    <number>0</number>
    <className>XWiki.JavaScriptExtension</className>
    <guid>bda1f669-a593-419e-ba7f-2ca97b79624c</guid>
    <class>
      <name>XWiki.JavaScriptExtension</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <cache>
        <cache>0</cache>
        <defaultValue>long</defaultValue>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <freeText>forbidden</freeText>
        <largeStorage>0</largeStorage>
        <multiSelect>0</multiSelect>
        <name>cache</name>
        <number>5</number>
        <prettyName>Caching policy</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators>|, </separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>long|short|default|forbid</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </cache>
      <code>
        <contenttype>PureText</contenttype>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>code</name>
        <number>2</number>
        <prettyName>Code</prettyName>
        <restricted>0</restricted>
        <rows>20</rows>
        <size>50</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </code>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <parse>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>parse</name>
        <number>4</number>
        <prettyName>Parse content</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </parse>
      <use>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <freeText>forbidden</freeText>
        <largeStorage>0</largeStorage>
        <multiSelect>0</multiSelect>
        <name>use</name>
        <number>3</number>
        <prettyName>Use this extension</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators>|, </separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>currentPage|onDemand|always</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </use>
    </class>
    <property>
      <cache>long</cache>
    </property>
    <property>
      <code>require(['jquery', 'xwiki-meta'], function ($, xm) {
  'use strict';
  
  var handleSubmit = function () {
    var chosenOption = $('#watchModal input[type="radio"]:checked').val();
    // This should be improved as the REST endpoint might not be the same
    var restUrl = xm.restURL;
    var queryParams = new URLSearchParams({
      "form_token": xm.form_token
    });
    var isFilterRemoval = false;
    var method = "PUT";
    if (chosenOption === 'watchPage') {
      var url = restUrl;
    } else if (chosenOption === 'watchSpace') {
      var url = restUrl.replace(/\/pages.*/, "");
    } else if (chosenOption === 'watchWiki') {
      var url = restUrl.replace(/\/spaces.*/, "");
    } else if (chosenOption == 'unwatchPage' || chosenOption == 'unblockPage') {
      var url = restUrl;
      method = 'DELETE';
    } else if (chosenOption == 'unwatchSpace' || chosenOption == 'unblockSpace') {
      var url = restUrl.replace(/\/pages.*/, "");
      method = 'DELETE';
    } else if (chosenOption == 'unwatchWiki' || chosenOption == 'unblockWiki') {
      var url = restUrl.replace(/\/spaces.*/, "");
      method = 'DELETE';
    } else if (chosenOption == 'blockPage') {
      var url = restUrl;
      queryParams.append("ignore", "true");
    } else if (chosenOption == 'blockSpace') {
      var url = restUrl.replace(/\/pages.*/, "");
      queryParams.append("ignore", "true");
    } else if (chosenOption == 'blockWiki') {
      var url = restUrl.replace(/\/spaces.*/, "");
      queryParams.append("ignore", "true");
    } else {
      console.error("Option " + chosenOption + " is not yet supported!");
    }
    if (url) {
      var ajaxUrl = url + "/notificationsWatches?" + queryParams.toString();
      if (!isFilterRemoval) {
        $.ajax(ajaxUrl, {
          method: method
        }).done(function () {
          window.location.reload();
        }).error(function (data) {
          console.error("Error when processing the request: " + data);
        });
      }
    }
  };
  
  var initWatchModal = function () {
    $('#watchModal .btn-primary').on('click', handleSubmit);
    $('#watchModal input[type="radio"]').on('change', function () {
      $('#watchModal .btn-primary').prop('disabled', false);
    });
    $('#watchModal input[type="radio"]').each(function () {
      var radioButton = $(this);
      var titleId = radioButton.attr('aria-labelledby');
      $('#' + titleId).parent('a').on('click', function() {
        radioButton.prop('checked', 'checked');
        $('#watchModal .btn-primary').prop('disabled', false);
      });
    });
  };
  
  (XWiki.isInitialized &amp;&amp; initWatchModal()) || document.observe('xwiki:dom:loaded',initWatchModal);
});</code>
    </property>
    <property>
      <name>Handle watch settings change</name>
    </property>
    <property>
      <parse>0</parse>
    </property>
    <property>
      <use>onDemand</use>
    </property>
  </object>
  <object>
    <name>XWiki.Notifications.Code.NotificationsWatchUIX</name>
    <number>0</number>
    <className>XWiki.StyleSheetExtension</className>
    <guid>7ed83c53-e0a3-4c5c-90ea-6aced2cc5363</guid>
    <class>
      <name>XWiki.StyleSheetExtension</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <cache>
        <cache>0</cache>
        <defaultValue>long</defaultValue>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <freeText>forbidden</freeText>
        <largeStorage>0</largeStorage>
        <multiSelect>0</multiSelect>
        <name>cache</name>
        <number>5</number>
        <prettyName>Caching policy</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators>|, </separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>long|short|default|forbid</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </cache>
      <code>
        <contenttype>PureText</contenttype>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>code</name>
        <number>2</number>
        <prettyName>Code</prettyName>
        <restricted>0</restricted>
        <rows>20</rows>
        <size>50</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </code>
      <contentType>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <freeText>forbidden</freeText>
        <largeStorage>0</largeStorage>
        <multiSelect>0</multiSelect>
        <name>contentType</name>
        <number>6</number>
        <prettyName>Content Type</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators>|, </separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>CSS|LESS</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </contentType>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <parse>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>parse</name>
        <number>4</number>
        <prettyName>Parse content</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </parse>
      <use>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <freeText>forbidden</freeText>
        <largeStorage>0</largeStorage>
        <multiSelect>0</multiSelect>
        <name>use</name>
        <number>3</number>
        <prettyName>Use this extension</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators>|, </separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>currentPage|onDemand|always</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </use>
    </class>
    <property>
      <cache>long</cache>
    </property>
    <property>
      <code>#watchModal {
  text-align: left;
}
.panel-heading a {
  color: black;
}
.panel-radio {
  padding: 8px 15px;
}</code>
    </property>
    <property>
      <contentType>CSS</contentType>
    </property>
    <property>
      <name>CSS</name>
    </property>
    <property>
      <parse>0</parse>
    </property>
    <property>
      <use>onDemand</use>
    </property>
  </object>
  <object>
    <name>XWiki.Notifications.Code.NotificationsWatchUIX</name>
    <number>0</number>
    <className>XWiki.UIExtensionClass</className>
    <guid>b2f477cd-c38c-4d5c-8b35-8abcb3f579cc</guid>
    <class>
      <name>XWiki.UIExtensionClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <async_cached>
        <defaultValue>0</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType/>
        <name>async_cached</name>
        <number>3</number>
        <prettyName>Cached</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </async_cached>
      <async_context>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <freeText>forbidden</freeText>
        <largeStorage>0</largeStorage>
        <multiSelect>1</multiSelect>
        <name>async_context</name>
        <number>4</number>
        <prettyName>Context elements</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator>, </separator>
        <separators>|, </separators>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <values>action=Action|doc.reference=Document|doc.revision|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.cookies|request.headers|request.parameters=Request parameters|request.remoteAddr|request.session|request.url=Request URL|request.wiki=Request wiki|sheet|user=User|wiki=Wiki</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </async_context>
      <async_enabled>
        <defaultValue>0</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType/>
        <name>async_enabled</name>
        <number>2</number>
        <prettyName>Asynchronous rendering</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </async_enabled>
      <content>
        <disabled>0</disabled>
        <editor>Text</editor>
        <name>content</name>
        <number>1</number>
        <prettyName>Executed Content</prettyName>
        <restricted>0</restricted>
        <rows>25</rows>
        <size>120</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </content>
      <extensionPointId>
        <disabled>0</disabled>
        <name>extensionPointId</name>
        <number>5</number>
        <prettyName>Extension Point ID</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </extensionPointId>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>6</number>
        <prettyName>Extension ID</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <parameters>
        <contenttype>PureText</contenttype>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>parameters</name>
        <number>7</number>
        <prettyName>Extension Parameters</prettyName>
        <restricted>0</restricted>
        <rows>10</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </parameters>
      <scope>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <freeText>forbidden</freeText>
        <largeStorage>0</largeStorage>
        <multiSelect>0</multiSelect>
        <name>scope</name>
        <number>8</number>
        <prettyName>Extension Scope</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators>|, </separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>wiki=Current Wiki|user=Current User|global=Global</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </scope>
    </class>
    <property>
      <async_cached>0</async_cached>
    </property>
    <property>
      <async_context/>
    </property>
    <property>
      <async_enabled>0</async_enabled>
    </property>
    <property>
      <content>{{velocity}}
## FIXME: this object should be cached / async once properly finished.
#set($discard = $xwiki.ssx.use('XWiki.Notifications.Code.NotificationsWatchUIX'))
#set($discard = $xwiki.jsx.use('XWiki.Notifications.Code.NotificationsWatchUIX'))
#macro (_displayReferenceInModal $entityReference)
  #if ($entityReference.type == 'WIKI')
    &lt;span class="entity-reference"&gt;&lt;span class="fa fa-globe"&gt;&lt;/span&gt; wiki $entityReference.name&lt;/span&gt;
  #elseif ($entityReference.type == 'SPACE')
    &lt;span class="entity-reference"&gt;&lt;span class="fa fa-sitemap"&gt;&lt;/span&gt; space $entityReference&lt;/span&gt;
  #elseif ($entityReference.type == 'PAGE')
    &lt;span class="entity-reference"&gt;&lt;span class="fa fa-file"&gt;&lt;/span&gt; page $entityReference&lt;/span&gt;
  #else
    &lt;span class="entity-reference"&gt;$entityReference&lt;/span&gt;
  #end
#end

#set ($watchedStatus = $services.notification.watch.getLocationWatchedStatus($doc))
## If the watched status informs that the filter is about children it means it's a filter for the space, 
## so we should look for ancestor of the space.
#set ($refForAncestorFirstFilter = $doc.getDocumentReference())
#if ($watchedStatus == 'WATCHED_WITH_CHILDREN_FOR_ALL_EVENTS_AND_FORMATS' || $watchedStatus == 'BLOCKED_WITH_CHILDREN_FOR_ALL_EVENTS_AND_FORMATS')
  #set ($refForAncestorFirstFilter = $doc.getDocumentReference().parent)
#end
#set ($ancestorFirstFilter = $services.notification.watch.getFirstFilteredAncestor($refForAncestorFirstFilter))
#if ($ancestorFirstFilter)
  #set ($ancestorRef = $ancestorFirstFilter.left)
  #set ($ancestorWatchStatus = $ancestorFirstFilter.right)
#end
## TODO: better way for that?
#set ($isTerminal = ($doc.getDocumentReference().name != 'WebHome'))
#if ($watchedStatus == 'WATCHED_FOR_ALL_EVENTS_AND_FORMATS')
  #set ($watchIcon = 'fa-bell')
  #set ($watchText = 'Followed')
  #set ($watchModalDescription = 'This page is followed: you will receive notifications for all event types.')
#elseif ($watchedStatus == 'WATCHED_BY_ANCESTOR_FOR_ALL_EVENTS_AND_FORMATS')
  #set ($watchIcon = 'fa-bell')
  #set ($watchText = 'Followed')
  #set ($watchModalDescription = 'This page is followed through another page in the hierarchy: you will receive notifications for all event types.')
#elseif ($watchedStatus == 'WATCHED_WITH_CHILDREN_FOR_ALL_EVENTS_AND_FORMATS')
  #set ($watchIcon = 'fa-bell')
  #set ($watchText = 'Followed')
  #set ($watchModalDescription = 'This page and its children are followed: you will receive notifications for all event types.')
#elseif ($watchedStatus == 'NOT_SET')
  #set ($watchIcon = 'fa-bell-o')
  #set ($watchText = 'Not set')
  #set ($watchModalDescription = 'There is no watch settings for this page: you won''t receive notifications for it.')
#elseif ($watchedStatus == 'BLOCKED_FOR_ALL_EVENTS_AND_FORMATS')
  #set ($watchIcon = 'fa-bell-slash')
  #set ($watchText = 'Blocked')
  #set ($watchModalDescription = 'This page is blocked: you won''t receive any notifications for it.')
#elseif ($watchedStatus == 'BLOCKED_BY_ANCESTOR_FOR_ALL_EVENTS_AND_FORMATS')
  #set ($watchIcon = 'fa-bell-slash')
  #set ($watchText = 'Blocked')
  #set ($watchModalDescription = 'This page is blocked through another page in the hierarchy: you won''t receive any notifications for it.')
#elseif ($watchedStatus == 'BLOCKED_WITH_CHILDREN_FOR_ALL_EVENTS_AND_FORMATS')
  #set ($watchIcon = 'fa-bell-slash')
  #set ($watchText = 'Blocked')
  #set ($watchModalDescription = 'This page and its children are blocked: you won''t receive any notifications for it.')
#else
  #set ($watchIcon = 'fa-bullhorn')
  #set ($watchText = 'Custom')
  #set ($watchModalDescription = 'The watch settings are custom for this page: you should review the filters applied for the page to know exactly which notifications you might receive.')
#end
{{html clean='false'}}
&lt;div class="btn-group" id="watchButton"&gt;
  &lt;a href="#" role="button" title="Watch" class="btn btn-default" data-toggle="modal" data-target="#watchModal"&gt;
    &lt;span class="fa $watchIcon"&gt;&lt;/span&gt; $watchText
  &lt;/a&gt;
&lt;/div&gt;
&lt;div class="modal fade" tabindex="-1" role="dialog" id="watchModal"&gt;
  &lt;div class="modal-dialog" role="document"&gt;
    &lt;div class="modal-content"&gt;
      &lt;div class="modal-header"&gt;
        &lt;button type="button" class="close" data-dismiss="modal" aria-label="Close"&gt;&lt;span aria-hidden="true"&gt;&amp;times;&lt;/span&gt;&lt;/button&gt;
        &lt;h4 class="modal-title"&gt;Watch settings&lt;/h4&gt;
      &lt;/div&gt;
      &lt;div class="modal-body"&gt;
        &lt;p&gt;$watchModalDescription&lt;/p&gt;
        #if ($isTerminal)
          &lt;p class="terminal-page-info"&gt;Note that this is a terminal page: some options you usually see for watching page and children are not displayed.&lt;/p&gt;
        #end
        &lt;div class="watch-options-container panel-group" id="watch-options-accordion" role="tablist" aria-multiselectable="false"&gt;
        #if ($watchedStatus == 'NOT_SET')
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-watch-page" value="watchPage" aria-labelledby="title-watch-page" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-watch-page"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-watch-page" aria-controls="xhint-watch-page"&gt;
                &lt;h4 class="panel-title" id="title-watch-page"&gt;
                  &lt;span class="fa fa-file"&gt;&lt;/span&gt; Follow current page
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-watch-page" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-watch-page"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will receive notifications for that page only.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #if (!$isTerminal)
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-watch-space" value="watchSpace" aria-labelledby="title-watch-space" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-watch-space"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-watch-space" aria-controls="xhint-watch-space"&gt;
                &lt;h4 class="panel-title" id="title-watch-space"&gt;
                  &lt;span class="fa fa-sitemap"&gt;&lt;/span&gt; Follow current page and its children
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-watch-space" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-watch-space"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will receive notifications for that page and its children.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #end
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-watch-wiki" value="watchWiki" aria-labelledby="title-watch-wiki" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-watch-wiki"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-watch-wiki" aria-controls="xhint-watch-wiki"&gt;
                &lt;h4 class="panel-title" id="title-watch-wiki"&gt;
                  &lt;span class="fa fa-globe"&gt;&lt;/span&gt; Follow current wiki
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-watch-wiki" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-watch-wiki"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will receive notifications for any page in the wiki, provided that no other filter exists.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #elseif ($watchedStatus == 'WATCHED_FOR_ALL_EVENTS_AND_FORMATS')
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-block-page" value="blockPage" aria-labelledby="title-block-page" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-block-page"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-block-page" aria-controls="xhint-block-page"&gt;
                &lt;h4 class="panel-title" id="title-block-page"&gt;
                  &lt;span class="fa fa-file"&gt;&lt;/span&gt; Block current page
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-block-page" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-block-page"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will stop receiving notifications for that page only.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #if (!$isTerminal)
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-block-space" value="blockSpace" aria-labelledby="title-block-space" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-block-space"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-block-space" aria-controls="xhint-block-space"&gt;
                &lt;h4 class="panel-title" id="title-block-space"&gt;
                  &lt;span class="fa fa-sitemap"&gt;&lt;/span&gt; Block current page and its children
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-block-space" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-block-space"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will stop receiving notifications for that page and all of its children.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #end
          #if ("$!ancestorWatchStatus" == '' || $ancestorWatchStatus.isBlocked())
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-unwatch-page" value="unwatchPage" aria-labelledby="title-unwatch-page" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-unwatch-page"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-unwatch-page" aria-controls="xhint-unwatch-page"&gt;
                &lt;h4 class="panel-title" id="title-unwatch-page"&gt;
                  &lt;span class="fa fa-file"&gt;&lt;/span&gt;  Unfollow current page
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-unwatch-page" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-unwatch-page"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will remove existing filter that allows to watch that page so you won't receive notifications for that page. However, since you're not blocking explicitely notifications, you might again receive notifications for that page if another filter is created in the hierarchy to watch page and children or to watch the whole wiki.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
           #end
          #elseif ($watchedStatus == 'WATCHED_WITH_CHILDREN_FOR_ALL_EVENTS_AND_FORMATS')
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-block-page" value="blockPage" aria-labelledby="title-block-page" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-block-page"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-block-page" aria-controls="xhint-block-page"&gt;
                &lt;h4 class="panel-title" id="title-block-page"&gt;
                  &lt;span class="fa fa-file"&gt;&lt;/span&gt; Block current page
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-block-page" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-block-page"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will stop receiving notifications for that page only.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-block-space" value="blockSpace" aria-labelledby="title-block-space" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-block-space"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-block-space" aria-controls="xhint-block-space"&gt;
                &lt;h4 class="panel-title" id="title-block-space"&gt;
                  &lt;span class="fa fa-sitemap"&gt;&lt;/span&gt; Block current page and its children
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-block-space" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-block-space"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will stop receiving notifications for that page and all of its children.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #if ("$!ancestorWatchStatus" == '' || $ancestorWatchStatus.isBlocked())
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-unwatch-space" value="unwatchSpace" aria-labelledby="title-unwatch-space" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-unwatch-space"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-unwatch-space" aria-controls="xhint-unwatch-space"&gt;
                &lt;h4 class="panel-title" id="title-unwatch-space"&gt;
                  &lt;span class="fa fa-sitemap"&gt;&lt;/span&gt;  Unfollow current page and its children
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-unwatch-space" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-unwatch-space"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will remove existing filter that allows to watch that page and its children so you won't receive notifications for those. However, since you're not blocking explicitely notifications, you might again receive notifications for that page if another filter is created in the hierarchy to watch page and children or to watch the whole wiki. Similarly if one or several of the children of this page have a watch filter you might still receive notifications for them.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
           #end
          #elseif ($watchedStatus == 'WATCHED_BY_ANCESTOR_FOR_ALL_EVENTS_AND_FORMATS')
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-block-page" value="blockPage" aria-labelledby="title-block-page" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-block-page"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-block-page" aria-controls="xhint-block-page"&gt;
                &lt;h4 class="panel-title" id="title-block-page"&gt;
                  &lt;span class="fa fa-file"&gt;&lt;/span&gt; Block current page
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-block-page" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-block-page"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will stop receiving notifications for that page only.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #if (!$isTerminal)
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-block-space" value="blockSpace" aria-labelledby="title-block-space" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-block-space"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-block-space" aria-controls="xhint-block-space"&gt;
                &lt;h4 class="panel-title" id="title-block-space"&gt;
                  &lt;span class="fa fa-sitemap"&gt;&lt;/span&gt; Block current page and its children
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-block-space" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-block-space"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will stop receiving notifications for that page and all of its children.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #end
          #if ($ancestorRef.type == 'WIKI')
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-unfollow-wiki" value="unwatchWiki" aria-labelledby="title-unfollow-wiki" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-unfollow-wiki"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-unfollow-wiki" aria-controls="xhint-unfollow-wiki"&gt;
                &lt;h4 class="panel-title" id="title-unfollow-wiki"&gt;
                  &lt;span class="fa fa-globe"&gt;&lt;/span&gt; Unfollow current wiki
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-unfollow-wiki" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-unfollow-wiki"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will remove existing filter allowing to receive notifications for any page on the whole wiki. So it will impact this page and you won't receive notifications anymore for it, but it will impact also notifications received for other pages on the wiki.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #end
          #if ($ancestorRef.type == 'SPACE')
          If none of the above actions suits your need you can also go to #_displayReferenceInModal($ancestorRef) for modifying the watch settings there: this is the first location with a filter impacting current page.
          #end
          #elseif ($watchedStatus == 'BLOCKED_FOR_ALL_EVENTS_AND_FORMATS')
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-watch-page" value="watchPage" aria-labelledby="title-watch-page" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-watch-page"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-watch-page" aria-controls="xhint-watch-page"&gt;
                &lt;h4 class="panel-title" id="title-watch-page"&gt;
                  &lt;span class="fa fa-file"&gt;&lt;/span&gt; Follow current page
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-watch-page" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-watch-page"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will start receiving notifications for that page only.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #if (!$isTerminal)
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-watch-space" value="watchSpace" aria-labelledby="title-watch-space" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-watch-space"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-watch-space" aria-controls="xhint-watch-space"&gt;
                &lt;h4 class="panel-title" id="title-watch-space"&gt;
                  &lt;span class="fa fa-sitemap"&gt;&lt;/span&gt; Block current page and its children
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-watch-space" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-watch-space"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will start receiving notifications for that page and all of its children.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #end
          #if ("$!ancestorWatchStatus" == '' || $ancestorWatchStatus.isWatched())
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-unblock-page" value="unblockPage" aria-labelledby="title-unblock-page" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-unblock-page"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-unblock-page" aria-controls="xhint-unblock-page"&gt;
                &lt;h4 class="panel-title" id="title-unblock-page"&gt;
                  &lt;span class="fa fa-file"&gt;&lt;/span&gt;  Unblock current page
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-unblock-page" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-unblock-page"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will remove existing filter that allows to block that page so you will receive notifications for that page. However, since you're not watching it explicitely, you might again have notifications blocked for that page if another filter is created in the hierarchy to block page and children.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
           #end
          #elseif ($watchedStatus == 'BLOCKED_WITH_CHILDREN_FOR_ALL_EVENTS_AND_FORMATS')
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-watch-page" value="watchPage" aria-labelledby="title-watch-page" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-watch-page"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-watch-page" aria-controls="xhint-watch-page"&gt;
                &lt;h4 class="panel-title" id="title-watch-page"&gt;
                  &lt;span class="fa fa-file"&gt;&lt;/span&gt; Follow current page
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-watch-page" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-watch-page"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will start receiving notifications for that page only.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-watch-space" value="watchSpace" aria-labelledby="title-watch-space" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-watch-space"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-watch-space" aria-controls="xhint-watch-space"&gt;
                &lt;h4 class="panel-title" id="title-watch-space"&gt;
                  &lt;span class="fa fa-sitemap"&gt;&lt;/span&gt; Follow current page and its children
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-watch-space" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-watch-space"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will start receiving notifications for that page and all of its children.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #if ("$!ancestorWatchStatus" == '' || $ancestorWatchStatus.isWatched())
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-unblock-space" value="unblockSpace" aria-labelledby="title-unblock-space" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-unblock-space"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-unblock-space" aria-controls="xhint-unblock-space"&gt;
                &lt;h4 class="panel-title" id="title-unblock-space"&gt;
                  &lt;span class="fa fa-sitemap"&gt;&lt;/span&gt;  Unblock current page and its children
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-unblock-space" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-unblock-space"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will remove existing filter that allows to block that page and its children so you will receive notifications for those. However, since you're not following explicitely them, you might again have notifications blocked for that page if another filter is created in the hierarchy to block page and children. Similarly if one or several of the children of this page have a block filter you will have notifications blocked for them.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
           #end
          #elseif ($watchedStatus == 'BLOCKED_BY_ANCESTOR_FOR_ALL_EVENTS_AND_FORMATS')
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-watch-page" value="watchPage" aria-labelledby="title-watch-page" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-watch-page"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-watch-page" aria-controls="xhint-watch-page"&gt;
                &lt;h4 class="panel-title" id="title-watch-page"&gt;
                  &lt;span class="fa fa-file"&gt;&lt;/span&gt; Follow current page
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-watch-page" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-watch-page"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will start receiving notifications for that page only.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #if (!$isTerminal)
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-watch-space" value="watchSpace" aria-labelledby="title-watch-space" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-watch-space"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-watch-space" aria-controls="xhint-watch-space"&gt;
                &lt;h4 class="panel-title" id="title-watch-space"&gt;
                  &lt;span class="fa fa-sitemap"&gt;&lt;/span&gt; Follow current page and its children
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-watch-space" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-watch-space"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will start receiving notifications for that page and all of its children.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #end
          #if ($ancestorRef.type == 'WIKI')
          &lt;div class="panel panel-default"&gt;
            &lt;div class="panel-radio"&gt;
              &lt;input type="radio" name="watch-option" id="option-unblock-wiki" value="unblockWiki" aria-labelledby="title-unblock-wiki" /&gt;
            &lt;/div&gt;
            &lt;div class="panel-heading" role="tab" id="heading-unblock-wiki"&gt;
              &lt;a role="button" data-toggle="collapse" data-parent="#watch-options-accordion" href="#xhint-unblock-wiki" aria-controls="xhint-unblock-wiki"&gt;
                &lt;h4 class="panel-title" id="title-unblock-wiki"&gt;
                  &lt;span class="fa fa-globe"&gt;&lt;/span&gt; Unblock current wiki
                &lt;/h4&gt;
              &lt;/a&gt;
            &lt;/div&gt;&lt;!-- end panel heading --&gt;
            &lt;div id="xhint-unblock-wiki" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-unblock-wiki"&gt;
              &lt;div class="panel-body xHint"&gt;
                 By selecting that option, you will remove existing filter that blocks notifications for any page on the whole wiki. So it will impact this page and you will receive notifications anymore for it, but it will impact also other pages on the wiki for which you will also receive notifications after the change.
               &lt;/div&gt;
            &lt;/div&gt;&lt;!-- end collapsed xhint --&gt;
          &lt;/div&gt;&lt;!-- end panel --&gt;
          #end
          #if ($ancestorRef.type == 'SPACE')
          If none of the above actions suits your need you can also go to #_displayReferenceInModal($ancestorRef) for modifying the watch settings there: this is the first location with a filter impacting current page.
          #end
          #end
        &lt;/div&gt;&lt;!-- end panel group --&gt;
        &lt;div class="modal-body-footer"&gt;
          You can find and manipulate all your custom filters for watch settings in &lt;a href="http://localhost:8080/xwiki/bin/view/XWiki/Admin?category=notifications#Hnotifications.settings.filters.preferences.custom.title"&gt;your notifications settings&lt;/a&gt;.
        &lt;/div&gt;
      &lt;/div&gt;&lt;!-- end modal body --&gt;
      &lt;div class="modal-footer"&gt;
        &lt;button type="button" class="btn btn-default" data-dismiss="modal"&gt;Close&lt;/button&gt;
        &lt;button type="button" class="btn btn-primary" disabled="disabled"&gt;Save changes&lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;&lt;!-- /.modal-content --&gt;
  &lt;/div&gt;&lt;!-- /.modal-dialog --&gt;
&lt;/div&gt;&lt;!-- /.modal --&gt;
{{/html}}
{{/velocity}}</content>
    </property>
    <property>
      <extensionPointId>org.xwiki.plaftorm.menu.content</extensionPointId>
    </property>
    <property>
      <name>org.xwiki.platform.notification.watch</name>
    </property>
    <property>
      <parameters>order=50</parameters>
    </property>
    <property>
      <scope>wiki</scope>
    </property>
  </object>
</xwikidoc>

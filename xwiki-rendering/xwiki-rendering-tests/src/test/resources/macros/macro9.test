.#-------------------------------------------------------------------------------------
.input|xwiki/2.0
.# Verify behavior when a macro fails to execute
.#-------------------------------------------------------------------------------------
Execution {{testfailingmacro/}} error
.#-----------------------------------------------------
.expect|event/1.0
.#-----------------------------------------------------
beginDocument
beginParagraph
onWord [Execution]
onSpace
beginMacroMarkerInline [testfailingmacro] [] []
beginFormat [NONE] [[class]=[xwikirenderingerror]]
onWord [Failed to execute macro: testfailingmacro]
endFormat [NONE] [[class]=[xwikirenderingerror]]
beginFormat [NONE] [[class]=[xwikirenderingerrordescription hidden]]
onVerbatim [stack trace here] [true]
endFormat [NONE] [[class]=[xwikirenderingerrordescription hidden]]
endMacroMarkerInline [testfailingmacro] [] []
onSpace
onWord [error]
endParagraph
endDocument
.#-----------------------------------------------------
.expect|xhtml/1.0
.#-----------------------------------------------------
<p>Execution <!--startmacro:testfailingmacro|-||-|--><span class="xwikirenderingerror">Failed to execute macro: testfailingmacro</span><span class="xwikirenderingerrordescription hidden"><tt class="wikimodel-verbatim">stack trace here</tt></span><!--stopmacro--> error</p>
.#-----------------------------------------------------
.expect|xwiki/2.0
.#-----------------------------------------------------
Execution {{testfailingmacro/}} error
.#-----------------------------------------------------
.input|xhtml/1.0
.#-----------------------------------------------------
<html><p>Execution <!--startmacro:testfailingmacro|-||-|--><span class="xwikirenderingerror">Failed to execute macro: testfailingmacro</span><span class="xwikirenderingerrordescription hidden"><tt class="wikimodel-verbatim">stack trace here</tt></span><!--stopmacro--> error</p></html>
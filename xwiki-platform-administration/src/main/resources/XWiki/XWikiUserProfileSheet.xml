<?xml version="1.0" encoding="UTF-8"?>
<xwikidoc>
<web>XWiki</web>
<name>XWikiUserProfileSheet</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent>XWiki.XWikiUserSheet</parent>
<creator>XWiki.Admin</creator>
<author>XWiki.Admin</author>
<customClass></customClass>
<contentAuthor>XWiki.Admin</contentAuthor>
<creationDate>1262856167000</creationDate>
<date>1262856167000</date>
<contentUpdateDate>1262856167000</contentUpdateDate>
<version>1.1</version>
<title></title>
<template></template>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment></comment>
<minorEdit>false</minorEdit>
<syntaxId>xwiki/2.0</syntaxId>
<hidden>false</hidden>
<content>{{velocity}}
#set($obj = $doc.getObject("XWiki.XWikiUsers"))
#set($obfuscateEmail = true)
#if(!$obj)
= $msg.get('xe.admin.users.sheet') =

{{info}}$msg.get('xe.admin.users.applyonusers'){{/info}}##
#else
$doc.use($obj)
{{html clean="false" wiki="true"}}
#set($username = $xwiki.getUserName($doc.fullName, false))
= $msg.get('platform.core.profile.title', [$username]) =

#if($xcontext.action == 'view')
  &lt;div class="vcard"&gt;
  &lt;span class="fn hidden"&gt;$username&lt;/span&gt;
#end
$xwiki.ssx.use("XWiki.XWikiUserSheet")##
$xwiki.ssx.use('Main.Dashboard')##
&lt;div class="dashboard dashboard${xcontext.action}"&gt;
  &lt;div class="dashboardleft"&gt;
    &lt;div class="userInfo"&gt;
      #if($xcontext.action == 'view' &amp;&amp; $hasEdit)
        &lt;div class="editProfileCategory"&gt;&lt;a href="$doc.getURL('inline', 'category=profile')"&gt;&lt;span class="hidden"&gt;$msg.get('platform.core.profile.category.profile.edit')&lt;/span&gt;&lt;/a&gt;&lt;/div&gt;
      #end
      ## Please do not insert extra empty lines here (as it affects the validity of the rendered xhtml)
      &lt;h1&gt;$msg.get('platform.core.profile.section.personal')&lt;/h1&gt;
      &lt;dl&gt;
        &lt;dt class="label"&gt;&lt;label&gt;$msg.get('platform.core.profile.firstname')&lt;/label&gt;&lt;/dt&gt;
        &lt;dd #if($xcontext.action == 'view')class="given-name"#end&gt;$doc.display('first_name')&lt;/dd&gt;
        &lt;dt class="label"&gt;&lt;label&gt;$msg.get('platform.core.profile.lastname')&lt;/label&gt;&lt;/dt&gt;
        &lt;dd #if($xcontext.action == 'view')class="family-name"#end&gt;$doc.display('last_name')&lt;/dd&gt;
        #if(($obj.getProperty('company') &amp;&amp; $obj.getProperty('company').getValue() != '') || $xcontext.action != 'view')
          &lt;dt class="label"&gt;&lt;label&gt;$msg.get('platform.core.profile.company')&lt;/label&gt;&lt;/dt&gt;
          &lt;dd #if($xcontext.action == 'view')class="org"#end&gt;$doc.display('company')&lt;/dd&gt;
        #end
        #if(($obj.getProperty('comment') &amp;&amp; $obj.getProperty('comment').getValue() != '') || $xcontext.action != 'view')
          &lt;dt class="label"&gt;&lt;label&gt;$msg.get('platform.core.profile.about')&lt;/label&gt;&lt;/dt&gt;
          &lt;dd #if($xcontext.action == 'view')class="note"#end&gt;$doc.display('comment')&lt;/dd&gt;
        #end
      &lt;/dl&gt;
      &lt;h1&gt;$msg.get('platform.core.profile.section.contact')&lt;/h1&gt;
      &lt;dl&gt;
        &lt;dt class="label"&gt;&lt;label&gt;$msg.get('platform.core.profile.email')&lt;/label&gt;&lt;/dt&gt;
        &lt;dd #if($xcontext.action=="view")class="email"#end&gt;#if($xcontext.action != 'view' || !$obfuscateEmail)$doc.display('email')#else $doc.display('email').replaceAll('@.*', '@ ~-~-~-~-~-~-')#end&lt;/dd&gt;
        &lt;dt class="label"&gt;&lt;label&gt;$msg.get('platform.core.profile.phone')&lt;/label&gt;&lt;/dt&gt;
        &lt;dd #if($xcontext.action == 'view')class="tel"#end&gt;$doc.display('phone')&lt;/dd&gt;
        &lt;dt class="label"&gt;&lt;label&gt;$msg.get('platform.core.profile.address')&lt;/label&gt;&lt;/dt&gt;
        &lt;dd #if($xcontext.action == 'view')class="adr"#end&gt;$doc.display('address')&lt;/dd&gt;
      &lt;/dl&gt;
      #set($hasBlog = ($obj.getProperty('blog') &amp;&amp; $obj.getProperty('blog').getValue() != ''))
      #set($hasBlogFeed = ($obj.getProperty('blogfeed') &amp;&amp; $obj.getProperty('blogfeed').getValue() != ''))
      #if($hasBlog || $hasBlogFeed || $xcontext.action != 'view')
       &lt;h1&gt;$msg.get('platform.core.profile.section.links')&lt;/h1&gt;
        &lt;dl&gt;
          #if($hasBlog || $xcontext.action != 'view')
            &lt;dt class="label"&gt;&lt;label&gt;$msg.get('platform.core.profile.blog')&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;$doc.display('blog')&lt;/dd&gt;
          #end
          #if($hasBlogFeed || $xcontext.action != 'view')
            &lt;dt class="label"&gt;&lt;label&gt;$msg.get('platform.core.profile.blogFeed')&lt;/label&gt;&lt;/dt&gt;
            &lt;dd&gt;$doc.display('blogfeed')&lt;/dd&gt;
          #end
        &lt;/dl&gt;
      #end
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class="dashboardright"&gt;
    #if ($xcontext.action == 'view')
      &lt;div class="userRecentChanges"&gt;
        &lt;h1&gt;$msg.get('platform.core.profile.section.recentChanges')&lt;/h1&gt;
{{/html}}
#set ($rcAuthor = [$doc.fullName])
#set ($rcChangesNb = 10)

{{include document="Main.RecentChanges"/}}

{{html clean="false"}}
      &lt;/div&gt;
    #end
  &lt;/div&gt;
  &lt;div class="dashboardspacer"&gt;&amp;nbsp;&lt;/div&gt;
&lt;/div&gt;
#if($xcontext.action == 'view')
  ## Close the vcard
  &lt;/div&gt;
#end
{{/html}}##
#end
{{/velocity}}</content>
</xwikidoc>
